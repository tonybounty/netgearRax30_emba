<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2023 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s): Pascal Eckmann
Contributor(s): Michael Messner, Stefan Haboeck
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s14_weak_func_radare_check.html" title="./../s14_weak_func_radare_check.html" >&laquo; Back to s14_weak_func_radare_check</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">libprinting-migrate-samba4.so</span></pre>
<br />
<pre>  RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         </pre>
<pre>  <span class="green">Full RELRO   </span>   <span class="green">Canary found   </span>   <span class="green">NX enabled </span>   <span class="orange">DSO          </span>   <span class="green">No RPATH </span>  <span class="green">No RUNPATH </span>  <span class="green">No Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> tear down of </span><span class="orange">libprinting-migrate-samba4.so</span></pre>
<br />
<pre>ldr r0, [r0]</pre>
<pre>bl sym.imp.map_werror_from_unix</pre>
<pre>ldr r2, [0x00003c18]</pre>
<pre>ldr r3, [0x00003c0c]</pre>
<pre>add r2, pc, r2</pre>
<pre>ldr r3, [r2, r3]</pre>
<pre>ldr r2, [r3]</pre>
<pre>ldr r3, [sp, 0x34]</pre>
<pre>eors r2, r3, r2</pre>
<pre>beq 0x3c00</pre>
<pre>bl sym.imp.__stack_chk_fail</pre>
<pre>ldrd r2, r3, [r0, 0x10]</pre>
<pre>ldr r1, [0x00003c1c]</pre>
<pre>add r3, r3, 0x760</pre>
<pre>add r2, r2, 1</pre>
<pre>add r3, r3, 0xc</pre>
<pre>add r1, pc, r1</pre>
<pre>str r3, [sp]</pre>
<pre>ldr r3, [r0, 0xc]</pre>
<pre>mov r0, r5</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>b 0x3aa4</pre>
<pre>add r1, sp, 0x2c</pre>
<pre>--</pre>
<pre>mov r7, r2</pre>
<pre>ldr r1, [ip, r1]</pre>
<pre>mov r5, r0</pre>
<pre>ldr r2, [sp, 0x4c]</pre>
<pre>ldr r8, [0x00003dc0]</pre>
<pre>ldr r1, [r1]</pre>
<pre>str r1, [sp, 0x2c]</pre>
<pre>mov r1, 0</pre>
<pre>mov r1, 0</pre>
<pre>str r1, [sp, 0x1c]</pre>
<pre>str r1, [sp, 0x18]</pre>
<pre>uxth r1, r3</pre>
<pre>lsr r3, r3, 0x10</pre>
<pre>add r8, pc, r8</pre>
<pre>str r1, [sp, 4]</pre>
<pre>ldr r1, [0x00003dc4]</pre>
<pre>str r3, [sp]</pre>
<pre>uxth r3, r2</pre>
<pre>lsr r2, r2, 0x10</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>bne 0x3ce0</pre>
<pre>--</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x4148</pre>
<pre>ldr r0, [sp, 0x3c]</pre>
<pre>bl sym.imp.win_errstr</pre>
<pre>mov r1, r0</pre>
<pre>ldr r0, [0x000043dc]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp.dbgtext</pre>
<pre>ldr r0, [sp, 0x3c]</pre>
<pre>b 0x40c4</pre>
<pre>cmp sb, 0</pre>
<pre>beq 0x42c0</pre>
<pre>ldrb r3, [sb]</pre>
<pre>cmp r3, 0</pre>
<pre>beq 0x42c0</pre>
<pre>ldr r1, [0x000043e0]</pre>
<pre>mov r3, sb</pre>
<pre>ldr r2, [sp, 0x30]</pre>
<pre>mov r0, r4</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>mov r8, r0</pre>
<pre>--</pre>
<pre>andeq sl, r0, r5, ror 23</pre>
<pre>strdeq sl, fp, [r0], -ip</pre>
<pre>andeq sp, r0, r7, ror pc</pre>
<pre>andeq sl, r0, lr, ror 23</pre>
<pre>andeq sl, r0, r5, lsl 24</pre>
<pre>mov ip, 0x1000</pre>
<pre>push {r0, r1, r2, r4, r5, r6, r7, r8, sb, lr}</pre>
<pre>sub ip, sp, ip</pre>
<pre>str r0, [ip, 0xfd8]</pre>
<pre>mov r6, r2</pre>
<pre>ldr r2, [sp, 0x28]</pre>
<pre>mov r5, r1</pre>
<pre>ldr r1, [0x00004480]</pre>
<pre>ldrb r7, [sp, 0x2c]</pre>
<pre>mov r4, r0</pre>
<pre>str r2, [sp]</pre>
<pre>ldr r2, [0x00004484]</pre>
<pre>add r1, pc, r1</pre>
<pre>ldrd r8, sb, [sp, 0x30]</pre>
<pre>add r2, pc, r2</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>beq 0x4474</pre>
<pre>--</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp, 0x40]</pre>
<pre>ldr r3, [0x000067f0]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp, 0x44]</pre>
<pre>mov sb, 0</pre>
<pre>add r3, sp, 0x88</pre>
<pre>mov r2, 0x14</pre>
<pre>mov r1, sb</pre>
<pre>mov r0, r3</pre>
<pre>str r3, [sp, 0x38]</pre>
<pre>str sb, [sp, 0x54]</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r3, [sp, 0x34]</pre>
<pre>mov r2, r7</pre>
<pre>ldr r1, [sp, 0x3c]</pre>
<pre>mov r0, r4</pre>
<pre>str sb, [sp, 0x58]</pre>
<pre>ldr r3, [r3, sl, lsl 2]</pre>
<pre>str r3, [sp, 0x30]</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, sb</pre>
<pre>mov r8, r0</pre>
<pre>--</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x6560</pre>
<pre>bl sym.imp.ntstatus_to_werror</pre>
<pre>str r0, [sp, 0x4c]</pre>
<pre>ldr r3, [sp, 0x4c]</pre>
<pre>cmp r3, 0</pre>
<pre>bne 0x609c</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.imp.get_mydnsdomname</pre>
<pre>subs sb, r0, 0</pre>
<pre>beq 0x6770</pre>
<pre>ldrb r3, [sb]</pre>
<pre>cmp r3, 0</pre>
<pre>beq 0x6770</pre>
<pre>bl sym.imp.lp_netbios_name</pre>
<pre>ldr r1, [0x00006820]</pre>
<pre>mov r2, r0</pre>
<pre>mov r3, sb</pre>
<pre>mov r0, r4</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>mov sb, r0</pre>
<pre>--</pre>
<pre>ldr r3, [0x00006824]</pre>
<pre>mov r2, r8</pre>
<pre>str r0, [sp]</pre>
<pre>mov r1, r5</pre>
<pre>mov r0, r4</pre>
<pre>str r6, [sp, 4]</pre>
<pre>add r3, pc, r3</pre>
<pre>bl 0x2810</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x65e0</pre>
<pre>bl sym.imp.ntstatus_to_werror</pre>
<pre>str r0, [sp, 0x4c]</pre>
<pre>ldr r3, [sp, 0x4c]</pre>
<pre>cmp r3, 0</pre>
<pre>bne 0x609c</pre>
<pre>ldr r1, [0x00006828]</pre>
<pre>mov r3, fp</pre>
<pre>mov r2, sb</pre>
<pre>mov r0, r4</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x6314</pre>
<pre>--</pre>
<pre>b 0x7c48</pre>
<pre>mov r0, r8</pre>
<pre>bl sym.imp.ndr_policy_handle_empty</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0x7b78</pre>
<pre>add r3, sp, 0x14</pre>
<pre>mov r2, r8</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>cmp r6, 0</pre>
<pre>beq 0x7bb4</pre>
<pre>ldrb r3, [r6]</pre>
<pre>cmp r3, 0</pre>
<pre>beq 0x7bb4</pre>
<pre>ldr r1, [0x00007d40]</pre>
<pre>mov r3, r6</pre>
<pre>mov r2, r5</pre>
<pre>mov r0, r4</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r5, r0, 0</pre>
<pre>moveq r3, 8</pre>
<pre>--</pre>
<pre>beq 0xae20</pre>
<pre>bl sym.imp.__stack_chk_fail</pre>
<pre>mov r0, r8</pre>
<pre>bl sym.imp.ndr_policy_handle_empty</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0xacdc</pre>
<pre>add r3, sp, 0x14</pre>
<pre>mov r2, r8</pre>
<pre>mov r1, r5</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>ldr r3, [r4, 4]</pre>
<pre>mov r0, r5</pre>
<pre>ldr r2, [0x0000ae50]</pre>
<pre>ldr r1, [0x0000ae54]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>str r7, [sp]</pre>
<pre>add r2, pc, r2</pre>
<pre>ldr r3, [r4, 8]</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>moveq r3, 8</pre>
<pre>--</pre>
<pre>str r5, [sp, 0x2c]</pre>
<pre>str r5, [sp, 0x34]</pre>
<pre>str r5, [sp, 0x38]</pre>
<pre>str r5, [sp, 0x3c]</pre>
<pre>bl sym.imp.memset</pre>
<pre>mov r2, 0x14</pre>
<pre>mov r1, r5</pre>
<pre>mov r0, fp</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r0, [0x0000b664]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp._talloc_stackframe</pre>
<pre>subs r4, r0, 0</pre>
<pre>moveq r0, 8</pre>
<pre>beq 0xb278</pre>
<pre>ldr r2, [0x0000b668]</pre>
<pre>mov r3, sb</pre>
<pre>ldr r1, [0x0000b66c]</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>bne 0xb29c</pre>
<pre>--</pre>
<pre>bl sym.imp.dcerpc_winreg_CreateKey</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0xb9e8</pre>
<pre>bl sym.imp.ntstatus_to_werror</pre>
<pre>str r0, [sp, 0x38]</pre>
<pre>ldr r8, [sp, 0x38]</pre>
<pre>cmp r8, 0</pre>
<pre>bne 0xba38</pre>
<pre>add sl, sp, 0x68</pre>
<pre>add r3, sp, 0x3c</pre>
<pre>mov r2, sl</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>ldr r2, [0x0000bcfc]</pre>
<pre>mov r3, fp</pre>
<pre>ldr r1, [0x0000bd00]</pre>
<pre>mov r0, r4</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r3, r0, 0</pre>
<pre>bne 0xba70</pre>
<pre>--</pre>
<pre>bl sym.imp.dcerpc_winreg_CreateKey</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0xbacc</pre>
<pre>bl sym.imp.ntstatus_to_werror</pre>
<pre>str r0, [sp, 0x38]</pre>
<pre>ldr r8, [sp, 0x38]</pre>
<pre>cmp r8, 0</pre>
<pre>bne 0xba38</pre>
<pre>add sb, sp, 0x68</pre>
<pre>add r3, sp, 0x3c</pre>
<pre>mov r2, sb</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>ldr r2, [0x0000bd04]</pre>
<pre>mov r3, fp</pre>
<pre>ldr r1, [0x0000bd08]</pre>
<pre>mov r0, r4</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r3, r0, 0</pre>
<pre>beq 0xba30</pre>
<pre>--</pre>
<pre>beq 0xbb6c</pre>
<pre>bl sym.imp.ntstatus_to_werror</pre>
<pre>str r0, [sp, 0x38]</pre>
<pre>ldr r8, [sp, 0x38]</pre>
<pre>cmp r8, 0</pre>
<pre>bne 0xba38</pre>
<pre>add sb, sp, 0x68</pre>
<pre>add r3, sp, 0x3c</pre>
<pre>mov r2, sb</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>ldr r3, [sp, 0x30]</pre>
<pre>mov r0, r4</pre>
<pre>ldr r2, [0x0000bd0c]</pre>
<pre>ldr r1, [0x0000bd10]</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, fp</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r3, r0, 0</pre>
<pre>beq 0xba30</pre>
<pre>--</pre>
<pre>add sl, pc, sl</pre>
<pre>ldr r3, [r3]</pre>
<pre>str r3, [sp, 0x4c]</pre>
<pre>mov r3, 0</pre>
<pre>bl sym.imp.memset</pre>
<pre>mov r2, 0x14</pre>
<pre>mov r1, 0</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r0, [0x0000bf7c]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp._talloc_stackframe</pre>
<pre>subs r4, r0, 0</pre>
<pre>moveq r0, 8</pre>
<pre>beq 0xbecc</pre>
<pre>ldr r2, [0x0000bf80]</pre>
<pre>mov r3, sb</pre>
<pre>ldr r1, [0x0000bf84]</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>moveq r3, 8</pre>
<pre>--</pre>
<pre>str r5, [sp, 0x24]</pre>
<pre>str r5, [sp, 0x2c]</pre>
<pre>str r5, [sp, 0x30]</pre>
<pre>str r5, [sp, 0x34]</pre>
<pre>bl sym.imp.memset</pre>
<pre>mov r2, 0x14</pre>
<pre>mov r1, r5</pre>
<pre>mov r0, sl</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r0, [0x0000c3e4]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp._talloc_stackframe</pre>
<pre>subs r4, r0, 0</pre>
<pre>moveq r0, 8</pre>
<pre>beq 0xc0e8</pre>
<pre>ldr r2, [0x0000c3e8]</pre>
<pre>mov r3, r8</pre>
<pre>ldr r1, [0x0000c3ec]</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>bne 0xc10c</pre>
<pre>--</pre>
<pre>ldr r3, [r3]</pre>
<pre>str r3, [sp, 0x44]</pre>
<pre>mov r3, 0</pre>
<pre>bl sym.imp.memset</pre>
<pre>mov r2, 0x14</pre>
<pre>mov r1, 0</pre>
<pre>mov r0, r8</pre>
<pre>add fp, pc, fp</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r0, [0x0000c760]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp._talloc_stackframe</pre>
<pre>subs r4, r0, 0</pre>
<pre>moveq r0, 8</pre>
<pre>beq 0xc53c</pre>
<pre>ldr r2, [0x0000c764]</pre>
<pre>mov r3, r7</pre>
<pre>ldr r1, [0x0000c768]</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r2, r0, 0</pre>
<pre>bne 0xc560</pre>
<pre>--</pre>
<pre>mov r1, r6</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp.dbgtext</pre>
<pre>b 0xc4d8</pre>
<pre>mov r0, r8</pre>
<pre>bl sym.imp.ndr_policy_handle_empty</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0xc624</pre>
<pre>add r3, sp, 0x14</pre>
<pre>mov r2, r8</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>ldr r2, [0x0000c784]</pre>
<pre>mov r3, r7</pre>
<pre>ldr r1, [0x0000c788]</pre>
<pre>mov r0, r4</pre>
<pre>str r6, [sp]</pre>
<pre>add r2, pc, r2</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>beq 0xc4d0</pre>
<pre>--</pre>
<pre>mov r1, r5</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.imp.dcerpc_winreg_CloseKey</pre>
<pre>add r3, sp, 0x38</pre>
<pre>mov r2, sl</pre>
<pre>str r3, [sp, 4]</pre>
<pre>mov r1, r5</pre>
<pre>ldr r3, [sp, 0x44]</pre>
<pre>mov r0, r6</pre>
<pre>str r3, [sp]</pre>
<pre>ldr r3, [sp, 0x40]</pre>
<pre>bl sym.imp.dcerpc_winreg_DeleteKey</pre>
<pre>subs r4, r0, 0</pre>
<pre>beq 0xe6cc</pre>
<pre>b 0xe780</pre>
<pre>ldr r3, [sp, 0x30]</pre>
<pre>mov r2, sb</pre>
<pre>ldr r1, [sp, 0x28]</pre>
<pre>mov r0, r5</pre>
<pre>ldr r3, [r3, r8, lsl 2]</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs fp, r0, 0</pre>
<pre>beq 0xe6cc</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> used </span><span class="orange">18</span> times </span><span class="orange">libprinting-migrate-samba4.so</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
