<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2023 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s): Pascal Eckmann
Contributor(s): Michael Messner, Stefan Haboeck
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s14_weak_func_radare_check.html" title="./../s14_weak_func_radare_check.html" >&laquo; Back to s14_weak_func_radare_check</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">libauth-samba4.so</span></pre>
<br />
<pre>  RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         </pre>
<pre>  <span class="green">Full RELRO   </span>   <span class="green">Canary found   </span>   <span class="green">NX enabled </span>   <span class="orange">DSO          </span>   <span class="green">No RPATH </span>  <span class="green">No RUNPATH </span>  <span class="green">No Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> tear down of </span><span class="orange">libauth-samba4.so</span></pre>
<br />
<pre>pop {r4, r5, r6, r7, r8, pc}</pre>
<pre>mov r0, 1</pre>
<pre>pop {r4, r5, r6, r7, r8, pc}</pre>
<pre>andeq r7, r2, ip, ror lr</pre>
<pre>andeq r7, r2, r4, lsl lr</pre>
<pre>strdeq r7, r8, [r2], -r4</pre>
<pre>mov ip, 0x1000</pre>
<pre>push {r4, r5, r6, r7, r8, lr}</pre>
<pre>sub ip, sp, ip</pre>
<pre>str r0, [ip, 0xfe8]</pre>
<pre>mov r4, r0</pre>
<pre>mov r7, r1</pre>
<pre>mov r6, r2</pre>
<pre>bl sym.imp.lp_username_map_cache_time</pre>
<pre>subs r5, r0, 0</pre>
<pre>popeq {r4, r5, r6, r7, r8, pc}</pre>
<pre>ldr r1, [0x000082a0]</pre>
<pre>mov r0, r4</pre>
<pre>mov r2, r7</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf_strupper_m</span></pre>
<pre>subs r4, r0, 0</pre>
<pre>popeq {r4, r5, r6, r7, r8, pc}</pre>
<pre>--</pre>
<pre>ldr r1, [r3, 4]</pre>
<pre>cmp r1, 0</pre>
<pre>ldreq r1, [0x00008cf4]</pre>
<pre>addeq r1, pc, r1</pre>
<pre>mov r0, r6</pre>
<pre>bl sym.imp.talloc_strdup</pre>
<pre>str r0, [fp]</pre>
<pre>mov r4, r7</pre>
<pre>b 0x8518</pre>
<pre>bl sym.imp.lp_username_map_cache_time</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0x8740</pre>
<pre>ldrb r4, [sl]</pre>
<pre>cmp r4, 0</pre>
<pre>beq 0x88dc</pre>
<pre>ldr r1, [0x00008cf8]</pre>
<pre>mov r3, r5</pre>
<pre>mov r2, sl</pre>
<pre>mov r0, r6</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r8, r0, 0</pre>
<pre>beq 0x8650</pre>
<pre>--</pre>
<pre>ble 0x8714</pre>
<pre>mov r1, r0</pre>
<pre>ldr r0, [0x00008d08]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp.dbgtext</pre>
<pre>ldr r1, [0x00008d0c]</pre>
<pre>mov r0, r8</pre>
<pre>add r1, pc, r1</pre>
<pre>bl sym.imp._talloc_free</pre>
<pre>cmp r4, 0</pre>
<pre>beq 0x87b8</pre>
<pre>ldr r0, [sp, 0x18]</pre>
<pre>cmn r0, 1</pre>
<pre>beq 0x8650</pre>
<pre>bl sym.imp.close</pre>
<pre>b 0x8650</pre>
<pre>ldr r1, [0x00008d10]</pre>
<pre>mov r2, r5</pre>
<pre>mov r0, r6</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf_strupper_m</span></pre>
<pre>subs r3, r0, 0</pre>
<pre>str r3, [sp]</pre>
<pre>--</pre>
<pre>ldr r3, [0x0000dd38]</pre>
<pre>mov r1, 0xa</pre>
<pre>ldr r2, [0x0000dd3c]</pre>
<pre>mov r0, r1</pre>
<pre>add r3, pc, r3</pre>
<pre>add r2, pc, r2</pre>
<pre>bl sym.imp.dbghdrclass</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0xd9f8</pre>
<pre>ldr r0, [0x0000dd40]</pre>
<pre>mov r1, r6</pre>
<pre>add r0, pc, r0</pre>
<pre>bl sym.imp.dbgtext</pre>
<pre>bl sym.imp.lp_winbind_separator</pre>
<pre>ldr r1, [0x0000dd44]</pre>
<pre>mov r2, r6</pre>
<pre>ldrb r3, [r0]</pre>
<pre>mov r0, r4</pre>
<pre>str r7, [sp]</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>mov r1, r0</pre>
<pre>--</pre>
<pre>ldr r1, [0x0000fc64]</pre>
<pre>mov r0, r4</pre>
<pre>add r1, pc, r1</pre>
<pre>bl sym.imp._talloc_free</pre>
<pre>mov r0, 0xc0000017</pre>
<pre>pop {r4, r5, r6, r7, r8, sb, sl, pc}</pre>
<pre>ldr r1, [0x0000fc68]</pre>
<pre>add r1, pc, r1</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.imp._talloc_free</pre>
<pre>b 0xfa74</pre>
<pre>ldr r1, [r6, 4]</pre>
<pre>mov r0, r4</pre>
<pre>mla r1, sb, r7, r1</pre>
<pre>add r7, r7, 1</pre>
<pre>bl sym.imp.sid_string_talloc</pre>
<pre>mov r2, r5</pre>
<pre>mov r3, r0</pre>
<pre>mov r1, sl</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>mov r5, r0</pre>
<pre>b 0xfab4</pre>
<pre>--</pre>
<pre>ldrne r2, [r3, 4]</pre>
<pre>strne r1, [r2, 4]</pre>
<pre>ldr r2, [sp, 8]</pre>
<pre>tst r2, 1</pre>
<pre>beq 0x113b4</pre>
<pre>ldr fp, [r3, 0xc]</pre>
<pre>ldr r3, [r3, 8]</pre>
<pre>ldr r2, [r3, 0xc]</pre>
<pre>str r2, [sp, 0xc]</pre>
<pre>bl sym.imp.lp_winbind_separator</pre>
<pre>ldr r1, [sp, 0x48]</pre>
<pre>ldrb r3, [r0]</pre>
<pre>mov r0, fp</pre>
<pre>ldr r2, [sp, 0xc]</pre>
<pre>ldr sl, [r1, 0xc]</pre>
<pre>ldr r1, [r1, 8]</pre>
<pre>ldr r1, [r1]</pre>
<pre>str r1, [sp]</pre>
<pre>ldr r1, [0x000118e4]</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>ldr r3, [sp, 0x48]</pre>
<pre>str r0, [sl]</pre>
<pre>--</pre>
<pre>beq 0x12944</pre>
<pre>bl sym.imp.lp_winbind_use_default_domain</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x12a6c</pre>
<pre>ldr r8, [r4]</pre>
<pre>bl sym.imp.lp_winbind_separator</pre>
<pre>ldrb r1, [r0]</pre>
<pre>mov r0, r8</pre>
<pre>bl sym.imp.strchr_m</pre>
<pre>cmp r0, 0</pre>
<pre>bne 0x12a6c</pre>
<pre>strb r0, [sl]</pre>
<pre>bl sym.imp.lp_winbind_separator</pre>
<pre>ldr r2, [r4]</pre>
<pre>ldr r1, [0x00012a84]</pre>
<pre>ldrb r3, [r0]</pre>
<pre>mov r0, r6</pre>
<pre>str r2, [sp]</pre>
<pre>mov r2, r5</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, 0</pre>
<pre>str r0, [r7]</pre>
<pre>--</pre>
<pre>movne r7, r0</pre>
<pre>mov r1, r4</pre>
<pre>mov r0, r5</pre>
<pre>str r3, [sp, 0x1c]</pre>
<pre>str r3, [sp, 0x20]</pre>
<pre>bl sym.imp.talloc_strdup</pre>
<pre>subs fp, r0, 0</pre>
<pre>bne 0x12b88</pre>
<pre>mov r4, 0xc0000017</pre>
<pre>b 0x12d80</pre>
<pre>bl sym.imp.strlower_m</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x12b18</pre>
<pre>bl sym.imp.lp_winbind_separator</pre>
<pre>ldr r1, [0x00012ef4]</pre>
<pre>mov r2, r7</pre>
<pre>ldrb r3, [r0]</pre>
<pre>mov r0, r5</pre>
<pre>str fp, [sp]</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs r1, r0, 0</pre>
<pre>beq 0x12b80</pre>
<pre>--</pre>
<pre>bl sym.imp.dbgtext</pre>
<pre>ldr r6, [0x00014e80]</pre>
<pre>b 0x14344</pre>
<pre>mov r0, r4</pre>
<pre>bl sym.imp.pdb_get_workstations</pre>
<pre>mov r1, r0</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.imp.talloc_strdup</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x14d6c</pre>
<pre>ldrb r3, [r0]</pre>
<pre>cmp r3, 0</pre>
<pre>beq 0x149c4</pre>
<pre>ldr r1, [0x00014e84]</pre>
<pre>mov r3, 0</pre>
<pre>str r0, [sp, 0x6c]</pre>
<pre>mov r0, r7</pre>
<pre>ldr r2, [r8]</pre>
<pre>add r1, pc, r1</pre>
<pre>str r3, [sp, 0x64]</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>subs sl, r0, 0</pre>
<pre>beq 0x14d6c</pre>
<pre>--</pre>
<pre>add r0, r7, 0x9c</pre>
<pre>bl sym.imp.memcpy</pre>
<pre>mov r4, 0</pre>
<pre>mov r2, 0xc8</pre>
<pre>mov r1, r7</pre>
<pre>mov r0, r5</pre>
<pre>bl sym.imp.memcpy</pre>
<pre>ldr r1, [r6, 4]</pre>
<pre>mov r0, r5</pre>
<pre>str r4, [r5, 0xc8]</pre>
<pre>str r4, [r5, 0xcc]</pre>
<pre>bl sym.imp.talloc_strdup</pre>
<pre>cmp r0, r4</pre>
<pre>mov r3, r0</pre>
<pre>str r0, [r5, 0xd4]</pre>
<pre>beq 0x15ad0</pre>
<pre>ldr r1, [0x00015bbc]</pre>
<pre>mov r0, r5</pre>
<pre>ldr r2, [r5, 0x34]</pre>
<pre>add r1, pc, r1</pre>
<pre><span class="red">bl sym.imp.talloc_asprintf</span></pre>
<pre>cmp r0, r4</pre>
<pre>str r0, [r5, 0xdc]</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> used </span><span class="orange">10</span> times </span><span class="orange">libauth-samba4.so</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
